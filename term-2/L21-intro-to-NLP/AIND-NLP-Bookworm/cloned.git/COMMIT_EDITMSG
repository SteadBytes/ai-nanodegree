Completed notebook with adjustments for newer API
